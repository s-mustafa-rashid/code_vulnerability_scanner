# Ollion Code Vulnerability Scanner

Ollion Code Vulnerability Scanner is a tool that scans Python, Terraform, and JavaScript code for common security vulnerabilities. The tool identifies potential security issues such as hardcoded secrets, SQL injection risks, command injection vulnerabilities, insecure cryptographic practices, and more.

## Features

- **Hardcoded Secrets Detection**: Identifies hardcoded AWS keys, passwords, tokens, and other secrets.
- **SQL Injection Detection**: Detects patterns that suggest SQL injection vulnerabilities (Python).
- **Command Injection Detection**: Finds the use of potentially dangerous functions like `os.system` and `subprocess.run` with user-provided input (Python).
- **Insecure Cryptography Detection**: Identifies the use of weak hashing algorithms (e.g., MD5, SHA1).
- **Insecure Function Usage Detection**: Detects the use of insecure functions like `eval`, `exec`, `pickle.load`, etc.
- **Hardcoded IP Addresses Detection**: Identifies hardcoded IP addresses.
- **Weak SSL/TLS Configuration Detection**: Detects weak SSL/TLS configurations.
- **Deprecated Libraries Detection**: Identifies the use of deprecated or insecure libraries.
- **Sensitive Logging Detection**: Detects logging of sensitive information such as passwords, keys, and personal data.

## Requirements

- Python 3.11 or later
- Flask 3.0.3

## Installation

1. Clone the repository:

    ```sh
    git clone https://github.com/your-username/code_security_scanner.git
    cd vulnerability scanner
    ```

2. Create and activate a virtual environment:

    ```sh
    python -m venv venv
    venv\Scripts\activate
    ```

3. Install the required packages:

    ```sh
    pip install -r requirements.txt
    ```

## Usage

1. Set the `FLASK_APP` environment variable:

    - **In PowerShell**:

        ```sh
        $env:FLASK_APP="run.py"
        ```

    - **In Command Prompt**:

        ```sh
        set FLASK_APP=run.py
        ```

2. Run the Flask application:

    ```sh
    flask run
    ```

3. Open your web browser and navigate to `http://127.0.0.1:5000`.

4. Upload a Python, Terraform, or JavaScript script to be scanned. The tool will analyze the script and display any detected security issues along with the line numbers where the issues were found.

## Example

Upload a script like this to test the Python scanner:

```python
import os
import subprocess
import hashlib
import pickle

def vulnerable_function(user_input):
    os.system(user_input)
    subprocess.run(user_input)

def insecure_hashing():
    h = hashlib.md5()
    h.update(b"some data")

def sql_injection(user_input):
    query = "SELECT * FROM users WHERE username = '%s'" % user_input

def hardcoded_ip():
    ip = "192.168.1.1"

def deprecated_lib_usage():
    import urllib

def sensitive_logging(password):
    import logging
    logging.info(f"User password is {password}")
```
Upload a script like this to test the JavaScript scanner:
```
// Hardcoded secret
const apiKey = "AIzaSyD7B-EXAMPLE";
const password = "supersecretpassword";

// Use of eval
eval("console.log('dangerous')");

// Use of document.write
document.write("Hello, world!");

// Weak crypto
const crypto = require('crypto');
const hash = crypto.createHash('md5').update('data').digest('hex');

// Hardcoded IP
const ip = "192.168.1.1";

// Deprecated library
const deprecatedCrypto = require('crypto');
```
Upload a script like this to test the Terraform scanner:
```
resource "aws_s3_bucket" "example" {
  bucket = "example-bucket"
  acl    = "public-read"
}

resource "aws_security_group" "example" {
  name        = "example_sg"
  description = "Allow all inbound traffic"
  ingress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }
}
```
The scanner will identify potential vulnerabilities in the above scripts and display them along with the line numbers where they occur.

## Contributing
Contributions are welcome! Please open an issue or submit a pull request with your changes.

## License
This project is licensed under the MIT License. See the LICENSE file for details.
