# Ollion Code Vulnerability Scanner

Ollion Code Vulnerability Scanner is a tool that scans Python, Terraform, JavaScript, JSON, and YAML code for common security vulnerabilities. The tool identifies potential security issues such as hardcoded secrets, command injection vulnerabilities, insecure cryptographic practices, insecure configuration, and more.

## Features

- **Hardcoded Secrets Detection**: Identifies hardcoded AWS keys, passwords, tokens, and other secrets.
- **Command Injection Detection**: Finds the use of potentially dangerous functions like `os.system` and `subprocess.run` with user-provided input (Python).
- **Insecure Cryptography Detection**: Identifies the use of weak hashing algorithms (e.g., MD5, SHA1).
- **Insecure Function Usage Detection**: Detects the use of insecure functions like `eval`, `exec`, `pickle.load`, etc.
- **Hardcoded IP Addresses Detection**: Identifies hardcoded IP addresses.
- **Deprecated Libraries Detection**: Identifies the use of deprecated or insecure libraries.
- **Insecure File Permissions Detection**: Detects insecure file permission settings (Python).
- **Sensitive Logging Detection**: Detects logging of sensitive information such as passwords, keys, and personal data (Python).
- **Insecure Temporary File Usage Detection**: Identifies improper usage of temporary files (Python).
- **Missing CSRF Protection Detection**: Ensures that CSRF protection is enabled for web form handlers (Python).
- **Insecure Security Group Rules Detection**: Detects security group rules that allow unrestricted access (Terraform).
- **Unencrypted Storage Detection**: Identifies storage resources that are not encrypted (Terraform).
- **Insecure S3 Bucket ACL Detection**: Detects insecure ACL configurations for S3 buckets (Terraform).
- **Overly Permissive IAM Policies Detection**: Identifies IAM policies that grant excessive permissions (Terraform).
- **Open Security Group Ports Detection**: Validates that security groups do not allow unrestricted access to sensitive ports (Terraform).
- **IAM Root User Usage Detection**: Ensures that IAM policies do not grant permissions to the root user (Terraform).
- **Unrestricted Egress Rules Detection**: Identifies egress rules that allow unrestricted outbound traffic (Terraform).
- **Publicly Accessible RDS Instances Detection**: Ensures that RDS instances are not publicly accessible (Terraform).
- **Plaintext Secrets in Variables Detection**: Ensures that sensitive information is not stored in plaintext in Terraform variables.
- **Missing MFA in IAM Policies Detection**: Enforces that IAM policies require multi-factor authentication (MFA).
- **JSON and YAML Analyses**: Detects hardcoded secrets and IP addresses in JSON and YAML files.

## Requirements

- Python 3.11 or later
- Flask 3.0.3 or later
- PyYAML 6.0 or later

## Installation

1. Clone the repository:

    ```sh
    git clone https://github.com/your-username/code_security_scanner.git
    cd code_security_scanner
    ```

2. Create and activate a virtual environment:

    ```sh
    python -m venv venv
    venv\Scripts\activate
    ```

3. Install the required packages:

    ```sh
    pip install -r requirements.txt
    ```

## Usage

1. Set the `FLASK_APP` environment variable:

    - **In PowerShell**:

        ```sh
        $env:FLASK_APP="run.py"
        ```

    - **In Command Prompt**:

        ```sh
        set FLASK_APP=run.py
        ```

2. Run the Flask application:

    ```sh
    flask run
    ```

3. Open your web browser and navigate to `http://127.0.0.1:5000`.

4. Upload a Python, Terraform, JavaScript, JSON, or YAML script to be scanned. The tool will analyze the script and display any detected security issues along with the line numbers where the issues were found.

## Example

### Python Script

**Upload a script like this to test the Python scanner:**

```python
import os
import subprocess
import hashlib
import pickle

def vulnerable_function(user_input):
    os.system(user_input)
    subprocess.run(user_input)

def insecure_hashing():
    h = hashlib.md5()
    h.update(b"some data")

def hardcoded_ip():
    ip = "192.168.1.1"

def deprecated_lib_usage():
    import urllib

def sensitive_logging(password):
    import logging
    logging.info(f"User password is {password}")
## Example

### Python Script

**Upload a script like this to test the Python scanner:**

```python
import os
import subprocess
import hashlib
import pickle

def vulnerable_function(user_input):
    os.system(user_input)
    subprocess.run(user_input)

def insecure_hashing():
    h = hashlib.md5()
    h.update(b"some data")

def hardcoded_ip():
    ip = "192.168.1.1"

def deprecated_lib_usage():
    import urllib

def sensitive_logging(password):
    import logging
    logging.info(f"User password is {password}")
```
**Upload a script like this to test the JavaScript scanner:**
```
// Hardcoded secret
const apiKey = "AIzaSyD7B-EXAMPLE";
const password = "supersecretpassword";

// Use of eval
eval("console.log('dangerous')");

// Use of document.write
document.write("Hello, world!");

// Weak crypto
const crypto = require('crypto');
const hash = crypto.createHash('md5').update('data').digest('hex');

// Hardcoded IP
const ip = "192.168.1.1";

// Deprecated library
const deprecatedCrypto = require('crypto');
```
**Upload a script like this to test the JSON scanner:**
```
{
  "api_key": "AIzaSyD7B-EXAMPLE",
  "database": {
    "host": "192.168.1.1",
    "password": "supersecretpassword"
  }
}
```
**Upload a script like this to test the Terraform scanner:**
```
# Hardcoded secrets
variable "aws_secret_key" {
    type = string
    default = "my_secret_access_key"
}

# Insecure security group
resource "aws_security_group" "example" {
    ingress {
        from_port   = 22
        to_port     = 22
        protocol    = "tcp"
        cidr_blocks = ["0.0.0.0/0"]
    }

    egress {
        from_port   = 0
        to_port     = 0
        protocol    = "-1"
        cidr_blocks = ["0.0.0.0/0"]
    }
}

# Unencrypted storage
resource "aws_ebs_volume" "example" {
    encrypted = false
}

# Insecure S3 ACL
resource "aws_s3_bucket" "example" {
    acl = "public-read"
}

# Insecure IAM policies
resource "aws_iam_policy" "example" {
    policy = jsonencode({
        Version = "2012-10-17"
        Statement = [
            {
                Effect = "Allow"
                Action = "*"
                Resource = "*"
            }
        ]
    })
}

# Publicly accessible RDS instance
resource "aws_db_instance" "example" {
    publicly_accessible = true
}

# Root user IAM policy
resource "aws_iam_policy" "root_policy" {
    policy = jsonencode({
        Version = "2012-10-17"
        Statement = [
            {
                Effect = "Allow"
                Action = "sts:AssumeRole"
                Resource = "arn:aws:iam::123456789012:root"
            }
        ]
    })
}
```
**Upload a script like this to test the Terraform scanner:**
```
api_key: AKIAABCDEFGHIJKLMNOP
database:
  host: 192.168.1.1
  password: mypassword123
```

The scanner will identify potential vulnerabilities in the above scripts and display them along with the line numbers where they occur.

## Contributing
Contributions are welcome! Please open an issue or submit a pull request with your changes.

## License
This project is licensed under the MIT License. See the LICENSE file for details.
